import{d as j,n as D,u as T,r as i,e as d,o,c as u,b as t,t as n,j as s,f as _,w as p,F as z,h as M,k as m,g as h,l as O,E as S,Q as P,p as $,a as L,_ as Q}from"./index-596b62d7.js";import{b as A,e as G,f as J,h as K}from"./discuss-26b3cf8a.js";import"./index-c70bcbaa.js";const W=v=>($("data-v-8614dc7f"),v=v(),L(),v),X={class:"discussHome Box"},Y={class:"content"},Z={class:"content-header"},ee={class:"title"},te={class:"info"},se={class:"content-main"},ae=W(()=>t("div",{class:"comment-header"},[t("h3",{class:"title"},"评论")],-1)),oe={class:"head"},ne={key:0},le={key:1},ce={class:"right"},re={class:"comment-md",id:"box-footer"},ie=j({__name:"discussHome",setup(v){const f=D(),I=T();let l=i({id:0,title:"",catagory:"",enable_review:0,content:"",create_time:"",uploader:0,type:0,type_id:0,introduce:"",user_click_count:0,user:{id:0,name:"",password:"",access:"",is_vip:0,rate:0,avatar:""}}),c=i({topic_id:f.query.id,content:"",reply_to:""}),b=i(""),E=i({topic_id:f.query.id,page_no:1,order:"asc"}),y=i([]);async function F(){const{data:a}=await A({topic_id:f.query.id});l.value=a}async function g(){const{data:a}=await G(E.value);y.value=a}async function V(){await J(c.value),g(),S.success("评论成功"),c.value.content="",c.value.reply_to=""}function N(a){c.value.reply_to=a.uploader,b.value=a.username,R()}function R(){document.getElementById("box-footer").scrollIntoView({behavior:"smooth"})}function U(a){P.confirm("确定删除该评论吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{await K({topic_id:f.query.id,review_id:a}),y.value=y.value.filter(r=>r.id!==a),S.success("删除成功")})}return F(),g(),(a,r)=>{const w=d("mavon-editor"),x=d("el-avatar"),C=d("el-link"),q=d("el-card"),B=d("el-button");return o(),u("div",X,[t("div",Y,[t("div",Z,[t("div",ee,n(s(l).title),1),t("div",te,[t("span",null,"上传者: "+n(s(l).user.name),1),t("span",null,"发布于: "+n(s(l).create_time),1),t("span",null,"浏览量: "+n(s(l).user_click_count),1)])]),t("div",se,[_(w,{class:"md",modelValue:s(l).content,"onUpdate:modelValue":r[0]||(r[0]=e=>s(l).content=e),subfield:!1,defaultOpen:"preview",toolbarsFlag:!1,editable:!1,scrollStyle:!0,ishljs:!0},null,8,["modelValue"])])]),_(q,{class:"comment"},{default:p(()=>[ae,(o(!0),u(z,null,M(s(y),(e,H)=>(o(),u("div",{class:"dicuss-content",key:H},[e.user.avatar?(o(),m(x,{key:1,size:"20",src:e.user.avatar,alt:""},null,8,["src"])):(o(),m(x,{key:0,size:"20",src:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",alt:""})),t("div",oe,[e.reply_to?(o(),u("h4",ne,n(e.username)+" 回复:@"+n(e.reply_name),1)):(o(),u("h4",le,n(e.username),1)),t("div",ce,[t("span",null,n(e.create_time),1),_(C,{underline:!1,onClick:k=>N(e)},{default:p(()=>[h("回复")]),_:2},1032,["onClick"]),s(I).userInfo.id==e.uploader?(o(),m(C,{key:0,underline:!1,onClick:k=>U(e.id)},{default:p(()=>[h("删除")]),_:2},1032,["onClick"])):O("",!0)])]),_(w,{class:"review-md",modelValue:e.content,"onUpdate:modelValue":k=>e.content=k,subfield:!1,defaultOpen:"preview",toolbarsFlag:!1,editable:!1,scrollStyle:!0,boxShadow:!1,ishljs:!0},null,8,["modelValue","onUpdate:modelValue"])]))),128))]),_:1}),t("div",re,[_(w,{modelValue:s(c).content,"onUpdate:modelValue":r[1]||(r[1]=e=>s(c).content=e)},null,8,["modelValue"]),s(c).reply_to?(o(),m(B,{key:1,type:"primary",onClick:V},{default:p(()=>[h("回复："+n(s(b)),1)]),_:1})):(o(),m(B,{key:0,type:"primary",onClick:V},{default:p(()=>[h("发表评论")]),_:1}))])])}}});const pe=Q(ie,[["__scopeId","data-v-8614dc7f"]]);export{pe as default};
