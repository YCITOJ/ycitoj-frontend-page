import{d as U,r as y,R as Z,e as I,o as p,c as q,f as s,j as t,A as B,n as O,m as G,k as M,w as d,_ as H,b as a,s as J,v as z,x as N,g as R,t as c,F as j,h as K,S as Q,l as L,E as A,u as W,i as X,N as Y,P as ee,T as te,p as se,a as ae}from"./index-596b62d7.js";import{f as oe,h as ne,i as le,b as ie,c as re,j as ce}from"./contest-e2535aed.js";import{_ as ue}from"./regList.vue_vue_type_script_setup_true_lang-305396e2.js";import"./index-c70bcbaa.js";const de={class:"md"},_e=U({__name:"contestMd",props:{information:{type:String,default:""}},setup(x){const g=x;let _=y("");return Z(()=>{_.value=g.information}),(w,h)=>{const f=I("mavon-editor");return p(),q("div",de,[s(f,{modelValue:t(_),"onUpdate:modelValue":h[0]||(h[0]=k=>B(_)?_.value=k:_=k),subfield:!1,defaultOpen:"preview",toolbarsFlag:!1,editable:!1,scrollStyle:!0,ishljs:!0,boxShadow:!1,previewBackground:"#eee",boxShadowStyle:"0 0 0 0"},null,8,["modelValue"])])}}}),me=U({__name:"problemList",props:["value"],setup(x){const g=x,_=O(),w=G();let h=y();Z(()=>{h.value=g.value.prob_list});function f(r){return String.fromCharCode(65+r)}const k=({row:r})=>r.ac==!0?"ac-row":"";function V(r){if(r){var u=r.split(" "),b=u[0].split("-");u=u[1].split(":");var C=new Date(b[0],b[1]-1,b[2],u[0],u[1],u[2]);return C}return new Date}function e(r){const u=new Date;if(V(g.value.end_time).getTime()<u.getTime()){let C=w.resolve({path:"/submit",query:{num:r.num,competeid:_.query.id,index:r.index,where:"contestTimeOut",contestId:_.query.id}});window.open(C.href,"_blank")}else{let C=w.resolve({path:"/submit",query:{num:r.num,competeid:_.query.id,index:r.index,where:"contest",contestId:_.query.id}});window.open(C.href,"_blank")}}return(r,u)=>{const b=I("el-table-column"),C=I("el-table");return p(),M(C,{data:t(h),style:{width:"100%"},onRowClick:e,"row-class-name":k},{default:d(()=>[s(b,{label:"编号",type:"index",index:f,width:"80",align:"center"}),s(b,{prop:"title",label:"题目"}),s(b,{prop:"ac_cnt",label:"通过",width:"80",align:"center"}),s(b,{prop:"subm_cnt",label:"提交",width:"80",align:"center"})]),_:1},8,["data"])}}});const fe=H(me,[["__scopeId","data-v-ef2beadf"]]),pe={class:"header"},he={class:"search"},ye={class:"btn"},ve={style:{"font-weight":"bold"}},be={class:"submit_frequency",style:{margin:"0"}},we={key:0,class:"submit_frequency",style:{margin:"0",color:"#67c23a","font-size":"20px"}},ge={key:1,class:"submit_frequency",style:{margin:"0",color:"#67c23a","font-size":"20px"}},ke={key:2,class:"submit_times",style:{margin:"0",color:"#a39e9b"}},Ce={key:3,class:"submit_times",style:{margin:"0",color:"#a39e9b"}},Se={key:4,class:"submit_frequency",style:{margin:"0",color:"#f56c6c","font-size":"20px"}},qe=U({__name:"rankList",setup(x,{expose:g}){const _=O();let w=y([]),h=y(1),f=y(!1),k=y([]),V=y({search:""}),e=y(!1);async function r(){const{data:o}=await oe({contest_id:_.query.id,page_no:h.value});if(o&&o.length==0){A.error("到底了"),f.value=!0;return}f.value=!1,w.value=o,w.value&&(k.value=w.value[0].detail)}async function u(){const{data:o}=await ne({contest_id:_.query.id});o&&w.value.unshift(o.data)}async function b(){const{data:o}=await le({contest_id:_.query.id,name:V.value.search});o&&w.value.unshift(o)}function C(){h.value--,r()}function F(){h.value++,r()}async function D(){h.value=1,e.value=!0,await r(),A.success("刷新成功"),setTimeout(()=>{e.value=!1},5e3)}function E({row:o,column:T}){if(T.label=="参赛者")return o.rate<1e3?{color:"grey"}:o.rate<1200?{color:"green"}:o.rate<1400?{color:"skyblue"}:o.rate<1600?{color:"blue"}:o.rate<1800?{color:"purple"}:{color:"red"}}return g({getRankList:r,getMyRank:u}),(o,T)=>{const i=I("el-button"),S=I("el-input"),v=I("el-table-column"),$=I("el-table");return p(),q(j,null,[a("div",pe,[a("div",he,[s(S,{modelValue:t(V).search,"onUpdate:modelValue":T[0]||(T[0]=m=>t(V).search=m),placeholder:"输入用户名",class:"input-with-select"},{append:d(()=>[s(i,{icon:t(J),onClick:b},null,8,["icon"])]),_:1},8,["modelValue"])]),a("div",ye,[z(s(i,{size:"small",type:"primary",onClick:D},{default:d(()=>[R("刷新")]),_:1},512),[[N,!t(e)]]),z(s(i,{size:"small",type:"primary",disabled:""},{default:d(()=>[R("刷新")]),_:1},512),[[N,t(e)]]),t(h)>1?(p(),M(i,{key:0,size:"small",type:"primary",onClick:C},{default:d(()=>[R("上一页")]),_:1})):(p(),M(i,{key:1,size:"small",type:"primary",disabled:""},{default:d(()=>[R("上一页")]),_:1})),t(f)?(p(),M(i,{key:3,size:"small",type:"primary",disabled:""},{default:d(()=>[R("下一页")]),_:1})):(p(),M(i,{key:2,size:"small",type:"primary",onClick:F},{default:d(()=>[R("下一页")]),_:1}))])]),s($,{data:t(w),"cell-style":E,center:""},{default:d(()=>[s(v,{prop:"rank",label:"名次",width:"100",align:"center"}),s(v,{fixed:"",prop:"name",label:"参赛者",width:"200"},{default:d(m=>[a("p",ve,c(m.row.name),1)]),_:1}),s(v,{fixed:"",prop:"solved",label:"总分",width:"120",align:"center"},{default:d(m=>[a("p",be,c(m.row.solved),1),z(a("p",{class:"submit_times",style:{margin:"0",color:"#a39e9b"}}," ("+c(parseInt((m.row.penalty/60).toString()))+":"+c(m.row.penalty%60)+") ",513),[[N,m.row.penalty%60>=10]]),z(a("p",{class:"submit_times",style:{margin:"0",color:"#a39e9b"}}," ("+c(parseInt((m.row.penalty/60).toString()))+":0"+c(m.row.penalty%60)+") ",513),[[N,m.row.penalty%60<10]])]),_:1}),(p(!0),q(j,null,K(t(k),(m,l)=>(p(),M(v,{key:m,label:String.fromCharCode(65+l),align:"center"},{default:d(n=>[n.row.detail[l].ac==!0&&n.row.detail[l].tries==0?(p(),q("p",we,[s(t(Q),{style:{width:"1em",height:"1em"}})])):L("",!0),n.row.detail[l].ac==!0&&n.row.detail[l].tries!=0?(p(),q("p",ge," +"+c(n.row.detail[l].tries),1)):L("",!0),n.row.detail[l].ac==!0&&n.row.detail[l].time%60>=10?(p(),q("p",ke," ("+c(parseInt((n.row.detail[l].time/60).toString()))+":"+c(n.row.detail[l].time%60)+") ",1)):L("",!0),n.row.detail[l].ac==!0&&n.row.detail[l].time%60<10?(p(),q("p",Ce," ("+c(parseInt((n.row.detail[l].time/60).toString()))+":0"+c(n.row.detail[l].time%60)+") ",1)):L("",!0),n.row.detail[l].ac==!1&&n.row.detail[l].tries!=0?(p(),q("p",Se," -"+c(n.row.detail[l].tries),1)):L("",!0)]),_:2},1032,["label"]))),128))]),_:1},8,["data"])],64)}}});const Ie=H(qe,[["__scopeId","data-v-e325e0c3"]]),P=x=>(se("data-v-c899a03b"),x=x(),ae(),x),xe={class:"top"},Ve={class:"Box"},$e={key:0,class:"btns"},Le={class:"title"},De={class:"info"},Te={class:"left"},Re={class:"list"},Me={class:"item"},ze={class:"item"},Ne={class:"item"},Be={class:"right"},Ue={key:0,class:"time-top"},Fe=P(()=>a("div",{class:"time-title"},"距比赛结束：",-1)),Ee={class:"time"},je={class:"hours item"},Ae=P(()=>a("span",{class:"icon"},":",-1)),Oe={class:"minutes item"},He=P(()=>a("span",{class:"icon"},":",-1)),Pe={class:"second item"},Ze={class:"contest Box"},Ge=U({__name:"home",setup(x){const g=O(),_=y(null),w=W();let h=y("question"),f=y({id:null,start_time:"",end_time:"",title:"",information:"",contest_type:null,state:null,prob_list:null}),k=y({time:null}),V=y(0),e=X({days:"0",hours:"00",minutes:"00",seconds:"00"}),r=y(!1),u=y(!1);async function b(){const{data:i}=await ie({id:g.query.id});f.value=i;const S=new Date(f.value.start_time),v=new Date(f.value.end_time),$=Math.abs(v.getTime()-S.getTime()),m=Math.floor($/(1e3*60*60)),l=Math.floor($%(1e3*60*60)/(1e3*60));l==0?k.value={time:`${m}小时`}:k.value={time:`${m}小时${l}分钟`},E()}async function C(){const i=await re({contest_id:g.query.id});V.value=i.data}const F=i=>{i.paneName=="rank"&&(_.value.getRankList(),_.value.getMyRank())};let D;function E(){const i=new Date,v=new Date(f.value.end_time)-i;if(v<=0){e.days=0,e.hours="00",e.minutes="00",e.seconds="00";return}r.value=!0,e.hours=o(Math.floor(v/(1e3*60*60))),e.minutes=o(Math.floor(v%(1e3*60*60)/(1e3*60))),e.seconds=o(Math.floor(v%(1e3*60)/1e3)),D=setInterval(()=>{e.seconds--,e.seconds=o(e.seconds),e.seconds<0&&(e.minutes--,e.minutes=o(e.minutes),e.seconds=59),e.minutes<0&&(e.hours--,e.hours=o(e.hours),e.minutes=59),e.hours<0&&(e.days--,e.hours=23),e.days<0&&(e.days=0,e.hours="00",e.minutes="00",e.seconds="00",clearInterval(D))},1e3)}function o(i){return i<10&&i>=0?"0"+i:i}async function T(){await ce({contest_id:g.query.id,div:1}),A.success("评分成功")}return b(),C(),Y(()=>{clearInterval(D),D=null}),(i,S)=>{const v=I("el-tooltip"),$=I("el-tab-pane"),m=I("el-tabs"),l=I("el-dialog");return p(),q(j,null,[a("div",xe,[a("div",Ve,[t(w).isSuperAdmin()?(p(),q("div",$e,[s(v,{class:"box-item",effect:"dark",content:"报名列表",placement:"bottom"},{default:d(()=>[s(t(ee),{style:{width:"2em",height:"2em","margin-right":"8px",color:"#fff"},onClick:S[0]||(S[0]=n=>B(u)?u.value=!0:u=!0)})]),_:1}),s(v,{class:"box-item",effect:"dark",content:"选手评分",placement:"bottom"},{default:d(()=>[s(t(te),{style:{width:"2em",height:"2em","margin-right":"8px",color:"#fff"},onClick:T})]),_:1})])):L("",!0),a("div",Le,c(t(f).title),1),a("div",De,[a("div",Te,[a("div",Re,[a("div",Me,"比赛时间："+c(t(f).start_time)+" 至 "+c(t(f).end_time),1),a("div",ze,"比赛时长："+c(t(k).time),1),a("div",Ne,"报名人数："+c(t(V)),1)])]),a("div",Be,[t(r)?(p(),q("div",Ue,[Fe,a("div",Ee,[a("div",je,c(t(e).hours),1),Ae,a("div",Oe,c(t(e).minutes),1),He,a("div",Pe,c(t(e).seconds),1)])])):L("",!0)])])])]),a("div",Ze,[s(m,{modelValue:t(h),"onUpdate:modelValue":S[1]||(S[1]=n=>B(h)?h.value=n:h=n),class:"demo-tabs",onTabClick:F},{default:d(()=>[s($,{label:"比赛说明",name:"description"},{default:d(()=>[s(_e,{information:t(f).information},null,8,["information"])]),_:1}),s($,{label:"题目",name:"question"},{default:d(()=>[s(fe,{value:t(f)},null,8,["value"])]),_:1}),s($,{label:"排名",name:"rank"},{default:d(()=>[s(Ie,{ref_key:"rankListComp",ref:_},null,512)]),_:1})]),_:1},8,["modelValue"])]),s(l,{title:"报名列表",modelValue:t(u),"onUpdate:modelValue":S[2]||(S[2]=n=>B(u)?u.value=n:u=n),width:"80%"},{default:d(()=>[s(ue,{contestId:t(g).query.id},null,8,["contestId"])]),_:1},8,["modelValue"])],64)}}});const Xe=H(Ge,[["__scopeId","data-v-c899a03b"]]);export{Xe as default};
