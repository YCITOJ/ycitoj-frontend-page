import{d as L,m as P,r as c,i as Z,e as i,o as p,c as y,f as e,w as l,j as u,F as q,h as R,g as r,k,b as j,A as S,l as D,E as w}from"./index-596b62d7.js";import{c as G,n as H}from"./topic-d11f504d.js";import"./index-c70bcbaa.js";const I={class:"addproblem Box"},K=j("template",{slot:"append"},[r("ms")],-1),Q=j("template",{slot:"append"},[r("MB")],-1),ee=L({__name:"addProblem",setup(W){const U=P(),g=c();let t=c({num:"",title:"",difficulty:"1",memory_limit:128,time_limit:1e3,content:"",is_public:"",judge_type:""});const $=[{value:"1",label:"入门"},{value:"2",label:"简单"},{value:"3",label:"中等"},{value:"4",label:"较难"},{value:"5",label:"困难"}],C=Z({num:[{required:!0,message:"请输入题目编号",trigger:"blur"},{pattern:/^[0-9A-Za-z]{2,10}$/,message:"编号只包含(2~10)数字和字母",trigger:"blur"}],title:[{required:!0,message:"请输入题目名称",trigger:"blur"}],memory_limit:[{required:!0,message:"请输入空间限制",trigger:"blur"},{pattern:/^[0-9]{1,10}$/,message:"输入空间格式不正确",trigger:"blur"}],time_limit:[{required:!0,message:"请输入时间限制",trigger:"blur"},{pattern:/^[0-9]{1,10}$/,message:"输入时间格式不正确",trigger:"blur"}]});let s=c(""),b=c([]),_=c("");async function z(f){f&&await f.validate(async(a,m)=>{if(a){if(t.value.judge_type=="choice"){let n={num:t.value.num,title:t.value.title,difficulty:t.value.difficulty,content:t.value.content,is_public:t.value.is_public,is_multi:!1,options:JSON.stringify(b.value),answer:JSON.stringify([_.value])};return await G(n),w.success("添加成功"),U.go(-1)}await H(t.value),U.push({name:"submit",query:{num:t.value.num,judgeType:t.value.judge_type,where:"topic"}}),w.success("题目创建成功")}else console.log("error submit!",m)})}function A(){s.value||w.error("选项不能为空"),b.value.push(s.value)}function E(f){b.value.splice(f,1)}return(f,a)=>{const m=i("el-input"),n=i("el-form-item"),J=i("el-option"),M=i("el-select"),x=i("el-form"),d=i("el-radio"),F=i("el-radio-group"),B=i("el-col"),v=i("el-button"),N=i("el-row"),O=i("mavon-editor");return p(),y("div",I,[e(x,{ref_key:"ruleFormRef",ref:g,rules:C,model:u(t),"label-width":"80px"},{default:l(()=>[e(n,{label:"题目编号",prop:"num"},{default:l(()=>[e(m,{modelValue:u(t).num,"onUpdate:modelValue":a[0]||(a[0]=o=>u(t).num=o)},null,8,["modelValue"])]),_:1}),e(n,{label:"题目名称",prop:"title"},{default:l(()=>[e(m,{modelValue:u(t).title,"onUpdate:modelValue":a[1]||(a[1]=o=>u(t).title=o)},null,8,["modelValue"])]),_:1}),e(x,{ref_key:"ruleFormRef",ref:g,rules:C,inline:!0,model:u(t),"label-width":"80px"},{default:l(()=>[e(n,{label:"题目难度",prop:"difficulty"},{default:l(()=>[e(M,{modelValue:u(t).difficulty,"onUpdate:modelValue":a[2]||(a[2]=o=>u(t).difficulty=o),clearable:"",placeholder:"请选择"},{default:l(()=>[(p(),y(q,null,R($,o=>e(J,{key:o.value,label:o.label,value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"时间限制",prop:"time_limit"},{default:l(()=>[e(m,{modelValue:u(t).time_limit,"onUpdate:modelValue":a[3]||(a[3]=o=>u(t).time_limit=o)},{default:l(()=>[K]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"空间限制",prop:"memory_limit"},{default:l(()=>[e(m,{modelValue:u(t).memory_limit,"onUpdate:modelValue":a[4]||(a[4]=o=>u(t).memory_limit=o)},{default:l(()=>[Q]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","model"]),e(n,{label:"题目类型",prop:"judge_type"},{default:l(()=>[e(F,{modelValue:u(t).judge_type,"onUpdate:modelValue":a[5]||(a[5]=o=>u(t).judge_type=o)},{default:l(()=>[e(d,{label:"common"},{default:l(()=>[r("传统")]),_:1}),e(d,{label:"spj"},{default:l(()=>[r("特判")]),_:1}),e(d,{label:"cf_remote"},{default:l(()=>[r("CF")]),_:1}),e(d,{label:"lab"},{default:l(()=>[r("lab")]),_:1}),e(d,{label:"choice"},{default:l(()=>[r("选择题")]),_:1})]),_:1},8,["modelValue"])]),_:1}),u(t).judge_type=="choice"?(p(),k(n,{key:0},{default:l(()=>[j("div",null,[e(N,null,{default:l(()=>[e(B,{span:12},{default:l(()=>[e(m,{modelValue:u(s),"onUpdate:modelValue":a[6]||(a[6]=o=>S(s)?s.value=o:s=o),placeholder:"输入选项"},null,8,["modelValue"])]),_:1}),e(B,{span:12},{default:l(()=>[e(v,{onClick:A},{default:l(()=>[r("添加")]),_:1})]),_:1})]),_:1}),(p(!0),y(q,null,R(u(b),(o,T)=>(p(),k(N,{key:o},{default:l(()=>[(p(),k(d,{class:"sel-radio",modelValue:u(_),"onUpdate:modelValue":a[7]||(a[7]=V=>S(_)?_.value=V:_=V),label:o,key:o},null,8,["modelValue","label"])),e(v,{onClick:V=>E(T),type:"danger",size:"small"},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])]),_:2},1024))),128))])]),_:1})):D("",!0),e(n,{label:"是否公开",prop:"is_public"},{default:l(()=>[e(F,{modelValue:u(t).is_public,"onUpdate:modelValue":a[8]||(a[8]=o=>u(t).is_public=o)},{default:l(()=>[e(d,{label:"1"},{default:l(()=>[r("公开")]),_:1}),e(d,{label:"0"},{default:l(()=>[r("不公开")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"编辑题目"},{default:l(()=>[e(O,{modelValue:u(t).content,"onUpdate:modelValue":a[9]||(a[9]=o=>u(t).content=o)},null,8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[e(v,{type:"primary",onClick:a[10]||(a[10]=o=>z(g.value))},{default:l(()=>[r("提交")]),_:1})]),_:1})]),_:1},8,["rules","model"])])}}});export{ee as default};
